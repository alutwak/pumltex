\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{puml}[2018/05/12]

\RequirePackage{fancyvrb}
\RequirePackage{graphicx}

\newenvironment{pumlpicture}[2]{%
  \edef\jobname{#1}
  \edef\fname{#1.pumltex}
  \edef\pumlwidth{#2}
  \VerbatimOut{\fname}}
{%
  \endVerbatimOut
  \immediate\write18{plantuml \fname}
  \includegraphics[width=\pumlwidth]{\jobname}
}

\endinput